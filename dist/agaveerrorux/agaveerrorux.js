/* Agave error ux page javascript */

/*
	Copyright (c) Microsoft Corporation.  All rights reserved.
*/


/*
    Your use of this file is governed by the Microsoft Services Agreement http://go.microsoft.com/fwlink/?LinkId=266419.

    This file also contains the following Promise implementation (with a few small modifications):
        * @overview es6-promise - a tiny implementation of Promises/A+.
        * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
        * @license   Licensed under MIT license
        *            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
        * @version   2.3.0
*/
var InfoType;(function(a){var c="SecurityInfo",b="Information";a[a["Error"]=0]="Error";a[a["Warning"]=1]="Warning";a[a[b]=2]=b;a[a[c]=3]=c})(InfoType||(InfoType={}));var SupportedLocales={"ar-sa":true,"bg-bg":true,"bn-in":true,"ca-es":true,"cs-cz":true,"da-dk":true,"de-de":true,"el-gr":true,"en-us":true,"es-es":true,"et-ee":true,"eu-es":true,"fa-ir":true,"fi-fi":true,"fr-fr":true,"gl-es":true,"he-il":true,"hi-in":true,"hr-hr":true,"hu-hu":true,"id-id":true,"it-it":true,"ja-jp":true,"kk-kz":true,"ko-kr":true,"lo-la":true,"lt-lt":true,"lv-lv":true,"ms-my":true,"nb-no":true,"nl-nl":true,"nn-no":true,"pl-pl":true,"pt-br":true,"pt-pt":true,"ro-ro":true,"ru-ru":true,"sk-sk":true,"sl-si":true,"sr-cyrl-cs":true,"sr-cyrl-rs":true,"sr-latn-cs":true,"sr-latn-rs":true,"sv-se":true,"th-th":true,"tr-tr":true,"uk-ua":true,"ur-pk":true,"vi-vn":true,"zh-cn":true,"zh-tw":true},SupportedError={APICallFailed:true,NotTrustedWAC:true};function _loadJs(c,b){var a=document.createElement("script");a.src=c;a.type="text/javascript";a.addEventListener("load",b);document.getElementsByTagName("head")[0].appendChild(a)}var PathToStringFile="/lib/1.1/hosted/{locale}/office_strings.js",Strings={};function _getUrlParams(){var c=window.location.href,b=c.split("?")[1],a={};try{b.split("&").forEach(function(c){var b=c.split("=");a[b[0]]=b[1]})}catch(d){}return a}function _showInfoBar(d,s){var r="presentation",b="class",i="div",p=d;if(d.length>255)d=d.substring(0,254);var j=document.createElement(i);j.setAttribute(b,"moe-infobar-body");var t=document.createElement(i);t.innerHTML=p;j.setAttribute("title",t.textContent);var f=document.createElement("table");f.setAttribute(b,"moe-infobar-infotable");f.setAttribute("role",r);for(var u,o=0;o<3;o++){u=f.insertRow(o);u.setAttribute("role",r)}var a=f.rows;a[0].insertCell(0);a[0].insertCell(1);a[0].cells[1].setAttribute("rowSpan","2");a[1].insertCell(0);a[1].insertCell(1);a[2].insertCell(0);a[2].insertCell(1);a[0].cells[0].setAttribute(b,"moe-infobar-top-left-cell");a[0].cells[1].setAttribute(b,"moe-infobar-message-cell");a[2].cells[1].setAttribute(b,"moe-infobar-button-cell");var h=document.createElement("img");h.src="images/moe_status_icons.png";var e,l=InfoType.Error;if(l===InfoType.Error)e="moe-infobar-error";else if(l===InfoType.Warning)e="moe-infobar-warning";else if(l===InfoType.Information)e="moe-infobar-info";else e="moe-infobar-secinfo";h.setAttribute(b,e);h.setAttribute("alt",p);a[0].cells[0].appendChild(h);var g=document.createElement("a");g.setAttribute(b,"moe-infobar-message-div");g.setAttribute("tabindex","1");if(s){var m=document.createElement("span");m.setAttribute(b,"moe-infobar-title");m.innerHTML=s;g.appendChild(m)}var n=document.createElement("span");n.setAttribute(b,"moe-infobar-message");n.innerHTML=d;g.appendChild(n);a[0].cells[1].appendChild(g);j.appendChild(f);var c=document.createElement(i);c.setAttribute(b,"moe-background");c.style.backgroundImage="url(images/agavedefaulticon96x96.png)";c.style.backgroundColor="white";c.style.opacity="1";c.style.filter="alpha(opacity=100)";c.style.backgroundRepeat="no-repeat";c.style.backgroundPosition="center";var k=document.createElement(i);k.setAttribute(b,"moe-infobar-out");k.appendChild(j);c.appendChild(k);var q=document.getElementById("container");q&&q.appendChild(c)}try{var urlParams=_getUrlParams();if(urlParams.locale&&SupportedLocales[urlParams.locale]&&urlParams.error&&SupportedError[urlParams.error]){var url=PathToStringFile.replace("{locale}",urlParams.locale);_loadJs(url,function(){_showInfoBar(Strings.OfficeOM["L_"+urlParams.error])})}}catch(err){}